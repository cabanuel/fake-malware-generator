// +build windows

package iocloader

import (
	_ "embed"
	"gopkg.in/yaml.v3"
	"log"
)

//go:embed configs/mal_lockbit.yml
var yamlMal []byte

type MalwareIocs struct {
	MalPaths []string `yaml:"MalPaths"`
	MalFiles []string `yaml:"MalFiles"` 
	MalStrings []string `yaml:"MalStrings"`
	MalCommands []string `yaml:"MalCommands"`
	MalBytes []string `yaml:"MalBytes"`
}

type Malware struct {
	Malware MalwareIocs `yaml:"Windows"`
}

func LoadIocs() (Malware){
	var malware Malware

	err := yaml.Unmarshal(yamlMal, &malware)

	if err !=nil {
		log.Fatal(err)
	}
	return malware
}